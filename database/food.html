<!--Page for database of food-->
<!DOCTYPE html>
<html>
    <head>
        <title>Fridge - Food Database</title> <!--The title that appears in the tab-->
        <link rel="icon" type="image/x-icon" href="/c/favicon.ico"> <!--I can add an icon later easily by doing this-->
        <link rel="stylesheet" href="/c/style.css"> <!--Link to the CSS file-->
        <script src="/c/include.js"></script> <!--Embeds the script for HTML includes in the page-->
        <script src="/dbc/dbglobal.js"></script> <!--Embeds the script for database access into the page-->
        <script>//Processing the contents of the form when submitted
            function submitForm(form) {
                const item = new Item( //Compiling the input into an 'Item' object
                    form['name'].value, //Retrieving a value from the form
                    form['useBy'].value,
                    form['unit'].value,
                    form['qty'].value,
                    form['added'].value,
                    form['expiry'].value
                );
                console.log(item);
                addItem(item, 'foodStore', console.log); //Adds the item to the database and logs the key
                return false //Prevents the form from reloading the page
            }
            function loadItems(items) {
                let list = ['test'];
                items.forEach(item => {
                    //Creating a list item    
                    list.push(`<li>
                            <div>${item.name}</div>
                            <div>
                                <span data-float='right'><input type='number' min='0' max='${item.qty}'>/${item.qty}${item.unit} <input type='submit' value='Use'></span>
                            </div>
                            <div>Added: ${item.added}</div>
                            <div>Best Before: ${item.expiry}</div>
                        </li>`)
                    });
                document.getElementById('output').innerHTML = list;
            };
            
        </script>
    </head>
    <body>
        <nav id="main" class="cf include-html" data-include-src="/c/navbar.html">
            <ul>
                <li><a href="/index.html">Home</a></li>
                <li><a href="/database/food.html">Fridge</a></li>
                <li><a href="/database/recipes.html">Recipes</a></li>
                <li><a href="/database/shopping.html">Shopping List</a></li>
                <li><a href="/help.html">Help</a></li>            
            </ul>
        </nav>
        <h1>Fridge</h1>

        <form class="cf" onsubmit="return submitForm(this)">
            <div><!--Will be used to separate different parts of the form-->
                <label for="name">Name: </label>
                <input type="text" name="name" id="name">
            </div><div>
                <label for="qty">Amount: </label>
                <input type="number" name="qty" id="qty" min="0">
                <select id="unit" name="unit">
                    <option value=""></option>
                    <option value="g">g</option>
                    <option value="kg">kg</option>
                    <option value="L">L</option>
                </select> 
            </div><div>
                <label for="added">Date Added: </label>
                <input type="date" name="added" id="added">
            </div><div>
                <select id="useBy" name="useBy"><!--The use by/best before selector-->
                    <option value=true>Use By</option>
                    <option value=false>Best Before</option>
                </select>
                <input type="date" name="expiry" id="expiry">
            </div>
            <input type="submit" value="Add Item">
            <input type="reset" value="Clear" data-float="right">
        </form>

        <ul id="output"><!--The list of items in the fridge-->
            <li>
                <div>Milk</div>
                <div>
                    <span data-float="right"><input type="number" min="0" max="4">/4L <input type="submit" value="Use"></span>
                </div>
                <div>Added: 05/07/2023</div>
                <div>Best Before: 08/07/2023</div>
            </li>
        </ul>
        <script>//Getting the items to display in the list
            getAllItems('foodStore', loadItems)
        </script>

        <footer class="cf include-html" data-include-src="/c/footer.html">
            <nav>
                <ul>
                    <li><a href="/index.html">Home</a></li>
                    <li><a href="/database/food.html">Fridge</a></li>
                    <li><a href="/database/recipes.html">Recipes</a></li>
                    <li><a href="/database/shopping.html">Shopping List</a></li>
                    <li><a href="/help.html">Help</a></li>
                </ul>
            </nav>
            <p class="right">
                Â©Oliver Glossop, 2023
            </p>
        </footer>
        <script>
            includeHTML();
        </script>
        
    </body>
</html>